{{define "title"}}Completed Tasks{{end}}

{{define "content"}}
<div class="header-container">
  <h1 class="page-title">Completed Tasks <span class="done-badge">{{len .Tasks}} items</span></h1>
  
  <div class="search-form">
    <label class="search-label">Search</label>
    <form action="/done" method="GET">
      <input class="search-input" type="text" name="q" value="{{.Query}}" placeholder="Search">
      <button type="submit" class="search-button">
        <i class="material-icons">search</i>
      </button>
    </form>
  </div>
</div>

<div class="button-container">
  <a href="/" class="main-btn">
    <i class="material-icons">arrow_back</i> BACK TO MAIN LIST
  </a>

  <a href="/add-task-page" class="done-btn" style="background-color: #FF4081;">
    <i class="material-icons">add</i> NEW TASK
  </a>
</div>

{{if eq (len .Tasks) 0}}
<div class="empty-message">
  <p>No completed tasks found. Complete a task to see it here.</p>
</div>
{{else}}
<div class="tasks-container">
  {{range .Tasks}}
  <div class="task-card">
    <div class="task-content">
      <h2 class="task-title">{{.Title}}</h2>
      
      <div class="task-info"><span class="task-info-label">Category:</span> {{.Category}}</div>
      <div class="task-info"><span class="task-info-label">Description:</span> {{.Description}}</div>
    </div>
    
    <div class="task-meta">
      <div class="task-date">{{.CreatedAt.Format "02 Jan 2006 15:04"}}</div>
      <div><span class="status-{{if .Status}}{{.Status}}{{else}}todo{{end}}">{{if .Status}}{{.Status}}{{else}}todo{{end}}</span></div>
    </div>
    
    <div class="task-actions">
      <form action="/update-task-status" method="POST" class="status-select-container">
        <input type="hidden" name="id" value="{{.ID}}">
        <select name="status" onchange="this.form.submit()" class="status-select">
          <option value="todo" {{if eq .Status "todo"}}selected{{end}}>Todo</option>
          <option value="doing" {{if eq .Status "doing"}}selected{{end}}>Doing</option>
          <option value="done" {{if eq .Status "done"}}selected{{end}}>Done</option>
          <option value="backlog" {{if eq .Status "backlog"}}selected{{end}}>Backlog</option>
        </select>
      </form>
      
      <form action="/delete-task" method="GET">
        <input type="hidden" name="id" value="{{.ID}}">
        <button class="delete-btn" type="submit">DELETE</button>
      </form>
    </div>
  </div>
  {{end}}
</div>
{{end}}
{{end}}

{{define "done"}}
  {{template "layout" .}}
{{end}} 